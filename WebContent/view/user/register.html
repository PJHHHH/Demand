<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>注册 - layuiAdmin</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
  <link rel="stylesheet" href="../../layuiadmin/style/login.css" media="all">
  <script src="https://www.jq22.com/jquery/jquery-1.10.2.js"></script>
</head>
<body>
  <div class="layadmin-user-login layadmin-user-display-show" id="LAY-user-login" style="display: none;">
    <div class="layadmin-user-login-main">
      <div class="layadmin-user-login-box layadmin-user-login-header">
        <h2>用户注册</h2>
        <p>河北省重大技术需求征集调查系统</p>
      </div>
      <form action="">
      <div class="layadmin-user-login-box layadmin-user-login-body layui-form">
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-username" for="username"></label>
          <input type="text" name="username" id="username" lay-verify="required" placeholder="用户名" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-password" for="password"></label>
          <input type="password" name="password" id="password" lay-verify="required" placeholder="用户密码" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-password" for="password1"></label>
          <input type="password" name="password1" id="password1" lay-verify="required" placeholder="确认密码" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-username" for="name"></label>
          <input type="text" name="name" id="name" placeholder="姓名" class="layui-input">
        </div>
        <div class="layui-form-item" style="margin-top: 20px">
	      <div class="layui-input-inline">
	      	<input type="radio" name="sex" value="男" title="男" checked>
	      	<input type="radio" name="sex" value="女" title="女">
	      </div>
        </div>
        
        <div class="layui-form-item" style="margin-top: 20px">
			<div class="layui-inline">
				<select id="province" name="province" class="province" lay-verify="required" lay-search lay-filter="province">
					<option value="">省份</option>
				</select>
			</div>
			<div class="layui-inline">
                <select id="city" name="city" class="city" lay-verify="required" lay-search lay-filter="city">
                    <option value="">地级市</option>
                </select>
			</div>
			<div class="layui-inline">
				<select id="district" name="district" class="district" lay-verify="required" lay-search>
					<option value="">县/区</option>
				</select>
			</div>
		</div>
		
		<div class="layui-form-item" style="margin-top: 20px">
          <label class="layadmin-user-login-icon layui-icon layui-icon-group" for="institution"></label>
          <input type="text" name="institution" id="institution" lay-verify="required" placeholder="工作单位" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="major"></label>
          <input type="text" name="major" id="major" lay-verify="required" placeholder="专业方向" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-survey" for="industry"></label>
          <input type="text" name="industry" id="industry" lay-verify="required" placeholder="所在行业" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="education"></label>
          <input type="text" name="education" id="education" placeholder="教育程度" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="job"></label>
          <input type="text" name="job" id="job" placeholder="职称" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="address"></label>
          <input type="text" name="address" id="address" placeholder="通讯地址" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="post"></label>
          <input type="text" name="post" id="post" placeholder="邮政编码" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="mobile"></label>
          <input type="text" name="mobile" id="mobile" placeholder="手机" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="phone"></label>
          <input type="text" name="phone" id="phone" placeholder="固定电话" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="email"></label>
          <input type="text" name="email" id="email" placeholder="邮箱" lay-verify="email" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="qq"></label>
          <input type="text" name="qq" id="qq" placeholder="QQ" lay-verify="number" class="layui-input">
        </div>
        <div class="layui-form-item">
          <label class="layadmin-user-login-icon layui-icon layui-icon-read" for="msn"></label>
          <input type="text" name="msn" id="msn" placeholder="MSN" class="layui-input">
        </div>
		
        <div class="layui-form-item">
          <input type="checkbox" name="agreement" lay-skin="primary" title="同意用户协议" checked>
        </div>
        <div class="layui-form-item">
          <button class="layui-btn layui-btn-fluid" lay-submit lay-filter="LAY-user-reg-submit">注 册</button>
        </div>
        <div class="layui-trans layui-form-item layadmin-user-login-other">
          <label>社交账号注册</label>
          <a href="javascript:;"><i class="layui-icon layui-icon-login-qq"></i></a>
          <a href="javascript:;"><i class="layui-icon layui-icon-login-wechat"></i></a>
          <a href="javascript:;"><i class="layui-icon layui-icon-login-weibo"></i></a>
          
          <a href="login.html" class="layadmin-user-jump-change layadmin-link layui-hide-xs">用已有帐号登入</a>
          <a href="login.html" class="layadmin-user-jump-change layadmin-link layui-hide-sm layui-show-xs-inline-block">登入</a>
        </div>
      </div>
      </form>
    </div>
    
    <div class="layui-trans layadmin-user-login-footer">
      
      <p>© 2020 <a href="" target="_blank">PJH</a></p>
    </div>

  </div>

<script src="../../layuiadmin/layui/layui.js"></script>  
<script src="../../js/area.js" type="text/javascript"></script>
<script src="../../js/selectMore.js" type="text/javascript"></script>
<script>
  layui.config({
    base: '../../layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'user'], function(){
    var $ = layui.$
    ,setter = layui.setter
    ,admin = layui.admin
    ,form = layui.form
    ,router = layui.router();

    form.render();

    //提交
    form.on('submit(LAY-user-reg-submit)', function(obj){
      var field = obj.field;
    });
  });
  $("form").submit(function(e){
      e.preventDefault();
      var username = $("input[name='username']").val();
      var pass = $("input[name='password']").val();
      var pass1 = $("input[name='password1']").val();
      var name = $("input[name='name']").val();
      var sex = $("input[type='radio']:checked").val(); 
      var city = $("#province option:selected").val() + " " + $("#city option:selected").val()+ " " + $("#district option:selected").val();
      var institution = $("input[name='institution']").val();
      var major = $("input[name='major']").val();
      var industry = $("input[name='industry']").val();
      var education = $("input[name='education']").val();
      var job = $("input[name='job']").val();
      var address = $("input[name='address']").val();
      var post = $("input[name='post']").val();
      var mobile = $("input[name='mobile']").val();
      var phone = $("input[name='phone']").val();
      var email = $("input[name='email']").val();
      var qq = $("input[name='qq']").val();
      var msn = $("input[name='msn']").val();
      if (pass != pass1) {
          layer.msg('两次输入的密码不一致');
      } else {
    	  layer.load(1);
          $.ajax({
              url: "do_user_reg",
              type: 'post',
              data: {
                  username: username,
                  password: pass,
                  name: name,
                  sex: sex,
                  city: city,
                  institution: institution,
                  major: major,
                  industry: industry,
                  education: education,
                  job: job,
                  address: address,
                  post: post,
                  mobile: mobile,
                  phone: phone,
                  email: email,
                  qq: qq,
                  msn: msn
              },
              success: function (data) {
                  layer.closeAll('loading');
                  if(data=="yes"){
                  	layer.open({
                          content: '注册成功，请前往登录！',
                          yes: function (layero, index) {
                          	window.location="login.html";
                          }
                      });
                  } else if(data=="no"){
                  	layer.open({
                  	    content: "用户名已经注册，请直接登录！"
                  	});
                  } else if(data=="error"){
                  	layer.open({
                  	    content: "注册失败！"
                  	});
                  }
              },
              error: function () {
                  layer.msg('网络错误');
                  layer.closeAll('loading')
              },
              dataType: "text"
          });
          return false;
      }
  });
</script>
</body>
</html>